name: Couldfoundry CI Lab
on: [push]

jobs:
  #build:
  #  runs-on: ubuntu-latest
  #  steps:
  #  - uses: actions/checkout@v1
  #  - name: Set up JDK 11
  #    uses: actions/setup-java@v1
  #    with:
  #      java-version: 11
  #  - name: Build with Gradle
  #    run: ./gradlew clean build
  #  - name: Add manifest to build result
  #    run: cp ./manifest.yaml ./build/libs
  #  - uses: actions/upload-artifact@v1
  #    with:
  #      name: github-action-lab-artifact
  #      path: build/libs
  deploy:
    runs-on: ubuntu-latest
    steps:
      #- name: Downlaod artifact
      #  uses: actions/download-artifact@v1
      #  with:
      #    name: github-action-lab-artifact
      - name: cf api
        uses: comsysto/cloudfoundry-action/cli@develop
        with:
          args: api 'https://api.run.pivotal.io'
      - name: cf auth
        uses: comsysto/cloudfoundry-action/cli@develop
        with:
          args:
            - auth
            - "${{ secrets.CF_USERNAME }}"
            - "${{ secrets.CF_PASSWORD }}"
      - name: cf target
        uses: comsysto/cloudfoundry-action/cli@develop
        with:
          args: target -o mvg -s development
